---
title: PyTorch ç¬”è®°
subtitle: Welcome ğŸ‘‹ 

# Summary for listings and search engines
summary: ä¸€äº› PyTorch ç¬”è®°

# Link this post with a project
projects: []

# Date published
date: '2024-02-08T00:00:00Z'

# Date updated
lastmod: '2024-02-08T00:00:00Z'

# Is this an unpublished draft?
draft: false

# Show this page in the Featured widget?
featured: false

# Featured image
# Place an image named `featured.jpg/png` in this page's folder and customize its options here.
image:
  caption: 'Image credit: [**Unsplash**](https://unsplash.com/photos/CpkOjOcXdUY)'
  focal_point: ''
  placement: 2
  preview_only: false

authors:
  - admin

tags:
  - Academic
  - å¼€æº

categories:
  - Demo
---

# PyTorch æ¡†æ¶å­¦ä¹ ç¬”è®°

é€šå¸¸è€Œè¨€ï¼Œå¯ä»¥å°†ä¸€ä¸ªå®Œæ•´çš„ PyTorch ç®—æ³•å¤§æ¡†æ¶åˆ†ä¸ºä¸‹é¢å‡ ä¸ªéƒ¨åˆ†ï¼š

- æœ€å¤–å±‚çš„ä¸»å‡½æ•°ï¼š
  - è¯»å–é…ç½®æ–‡ä»¶ï¼Œè®¾ç½®å„é¡¹å‚æ•°
  - æ—¥å¿—
  - è®­ç»ƒ / æµ‹è¯•æµç¨‹
- Dataset å’Œ Data Loader éƒ¨åˆ†
  - Dataset éƒ¨åˆ†
  - Data Loader éƒ¨åˆ†
- Runner æˆ–è€… Schedule éƒ¨åˆ†
- æ ¸å¿ƒï¼šç½‘ç»œéƒ¨åˆ†



## Dataset å’Œ DataLoader éƒ¨åˆ†

> è¿™ä¸¤éƒ¨åˆ†è´Ÿè´£å°†æ•°æ®æ•´ç†å¥½ï¼Œå…·ä½“è€Œè¨€ï¼š
>
> - Dataset ç±»éœ€è¦è‡ªå®šä¹‰å¥½ä¸‰ä¸ªå‡½æ•°ï¼ˆ`__init__(self)`ï¼Œ`__len__(self)`ï¼Œ`__getitem__(self, index)`ï¼‰ï¼Œè¿™ä¸ªç±»çš„æ ¸å¿ƒä»»åŠ¡å°±æ˜¯åˆ›å»ºé€‚åº”å½“å‰æ¨¡å‹çš„æ•°æ®é›†æ¥å£
> - DataLoader åˆ™ç›¸å¯¹å®¹æ˜“ï¼ŒåŸºæœ¬ä¸Šåªè¦å‰é¢è¿™ä¸ª Dataset ç±»æå¥½ä¹‹åï¼Œæ„å»º DataLoader æ˜¯éå¸¸å®¹æ˜“çš„

### Dataset éƒ¨åˆ†

#### 1. Dataset ç±»æ¨¡æ¿

å¯¹äº 2D Vision è€Œè¨€ï¼ŒåŸºæœ¬çš„ Dataset ç±»æ¨¡æ¿æ¡†æ¶å¦‚ä¸‹ï¼š

```py
class CashDataset(Dataset):
    # 1. æ„é€ å‡½æ•°
    def __init__(self, data_dir, transform=None):
        self.data_path = """ å†™ä¸€ä¸ªä»æ•°æ®é›†ç›®å½•'data_dir'ä¸­æ”¶é›†ç›®æ ‡å›¾åƒåœ°å€çš„å‡½æ•°"""
        self.transform = transform    # å¯¹æ ·æœ¬(å›¾åƒ/æ–‡æœ¬)è¿›è¡Œå¤„ç†çš„å‡½æ•°ï¼Œæœ€å¥½æ˜¯å¤–é¢å†™å¥½å†è¾“å…¥è¿›æ¥
 	# 2. è·å–å•ä¸€æ•°æ®æ ·æœ¬çš„å‡½æ•°
    def __getitem__(self, index):
        path_img (,label) = self.data_path[index]	# è·å–å•ä¸€å›¾åƒï¼ˆæˆ–è€…å…¶ä»–å¯¹åº”çš„ labelï¼‰
        img = Image.open(path_img).convert('RGB')   # ç”¨ PIL åº“æ‰“å¼€å›¾åƒ  
 		if self.transform is not None:
            img = self.transform(img)   # å¯¹è¾“å…¥å›¾åƒè¿›è¡Œå¤„ç†ï¼ˆå¤„ç†å®Œä¹‹åå¿…é¡»æ˜¯ tensor ç±»å‹ï¼‰
		return img(, label)	            # è¿”å›å›¾åƒï¼ˆå’Œå¯¹åº”çš„å…¶ä»–æ ‡ç­¾ç­‰ä¸œè¥¿ï¼‰
 	# 3. è·å–æ•´ä¸ªæ•°æ®é›†é•¿åº¦çš„å‡½æ•°
    def __len__(self):
        return len(self.data_path)

```

è¿™ä¸ªæ¡†æ¶ä¸­æ¯”è¾ƒé‡è¦çš„ä¸¤ç‚¹ï¼š

- è¦ä»ç»™å®šçš„æ•´ä¸ªæ•°æ®é›†ç›®å½•ä¸­æ•´åˆå‡ºæ ·æœ¬ç›®å½•ä»¥åŠæ¯ä¸ªæ ·æœ¬ç›¸å¯¹åº”çš„æ ‡ç­¾ç›®å½•ï¼Œè¿™ä¸ªå‡½æ•°è¦è‡ªå·±å†™
- å¯¹äºæ•°æ®é›†ä¸­çš„æ¯ä¸€ä¸ªæ•°æ®æ ·æœ¬ï¼Œæ˜¯å¦è¦å¯¹å…¶è¿›è¡Œæ•°æ®å¢å¼ºï¼ˆData Augmentationï¼‰ï¼Ÿã€è®­ç»ƒæ—¶å’Œæµ‹è¯•æ—¶çš„å¤„ç†è‚¯å®šæ˜¯ä¸ä¸€æ ·çš„ï¼ã€‘å¦‚æœè¦è¿›è¡Œæ•°æ®å¢å¼ºï¼Œåˆ™éœ€è¦å€ŸåŠ© PyTorch ä¸­çš„`torchvision.transforms`ã€2D Visionï¼Œå¦‚æœæ˜¯å…¶ä»–ä»»åŠ¡å¯èƒ½å¾—æ‰¾åˆ«çš„å¤„ç†æ–¹æ³•ã€‘



#### 2. torchvision.transform æ¨¡å—ç¬”è®°

å¯¹äº 2D Vision ä»»åŠ¡è€Œè¨€ï¼Œå…¶å®å¯ä»¥å°†è®¸å¤šå›¾åƒå¢å¼ºçš„æ¨¡å—éƒ½æ•´åˆåˆ°è¿™ä¸ª`torchvision.transform` æ¨¡å—é‡Œé¢ã€è¿ Resizeï¼ŒCrop è¿™äº›éƒ½æ˜¯å¯ä»¥çš„ã€‘

> å¯¹äº torchvision.transform æ¨¡å—è€Œè¨€ï¼Œéœ€è¦æˆ‘ä»¬å…ˆç”¨ `PIL.Image` åº“æ‰“å¼€å›¾åƒ



##### 2.1 å®¹å™¨ç±» `transforms.Compose`

é¦–å…ˆéœ€è¦çŸ¥é“çš„æ˜¯å®¹å™¨ç±» `transforms.Compose`ï¼Œè¿™ä¸ªç±»çš„ä»»åŠ¡åªæœ‰ä¸€ä¸ªï¼šå°†ä¸€å † transform æ–¹æ³•æ•´åˆåˆ°ä¸€èµ·ç§°ä¸ºä¸€ä¸ª Pipelineï¼Œä¾‹å¦‚ï¼š

```py
from PIL import Image
from torchvision import transforms
img = Image.open("img å›¾ç‰‡çš„è·¯å¾„")	# å…ˆç”¨ PIL åº“æ‰“å¼€å›¾åƒ

# transforms.Compose([...])ï¼šå°†å…¶ä»–å›¾åƒå¤„ç†æ–¹æ³•å…¨éƒ¨æ•´åˆåˆ°é‡Œé¢ã€ç”¨åˆ—è¡¨åŒ…è£…ã€‘
transformer = transforms.Compose([                                
    transforms.Resize(256),
    transforms.transforms.RandomResizedCrop((224), scale = (0.5,1.0)),	
    transforms.RandomHorizontalFlip(),
    transforms.ToTensor()	# ä¸ç®¡å‰é¢æ€ä¹ˆæ“ä½œï¼Œæœ€åè¦æŠŠå›¾åƒè½¬æ¢ä¸º Tensor
])
# åº”ç”¨æ¨¡å—çš„æ–¹æ³•ï¼šç›´æ¥å¥—ç”¨
img_transformed = transformer(img)
```



##### 2.2 å„ç§å›¾åƒå˜æ¢æ–¹æ³•æ€»ç»“

`torchvision.transform` ä¸­å¸¸è§çš„å›¾åƒå˜æ¢æ–¹æ³•ï¼š

- **å¯¹å›¾åƒè¿›è¡Œè£å‰ªï¼ˆCropï¼‰ï¼š**
  - :star:ä¸­å¿ƒè£å‰ªï¼š                          `transforms.CenterCrop`
  - :star:éšæœºè£å‰ªï¼š                          `transforms.RandomCrop`
  - éšæœºé•¿å®½æ¯”è£å‰ªï¼š                  `transforms.RandomResizedCrop`
  - ä¸Šä¸‹å·¦å³ä¸­å¿ƒè£å‰ªï¼š              `transforms.FiveCrop`
  - ä¸Šä¸‹å·¦å³ä¸­å¿ƒè£å‰ªåç¿»è½¬ï¼š`transforms.TenCrop`
- **å¯¹å›¾åƒè¿›è¡Œç¿»è½¬å’Œæ—‹è½¬ï¼ˆFlip and Rotationï¼‰ï¼š**
  - :star:ä»¥æ¦‚ç‡ $p$ æ°´å¹³ç¿»è½¬ï¼š`transforms.RandomHorizontalFlip(p=0.5)`
  - :star:ä»¥æ¦‚ç‡ $p$ å‚ç›´ç¿»è½¬ï¼š`transforms.RandomVerticalFlip(p=0.5)`
  - :star:éšæœºæ—‹è½¬ï¼š                  `transforms.RandomRotation`
- **å¯¹å›¾åƒè¿›è¡Œå…¶ä»–å˜æ¢ï¼š**
  - :star:ä¸Š / ä¸‹é‡‡æ ·ï¼ˆResizeï¼‰ï¼š       `transforms.Resize`
  - :star:å°† PIL å›¾åƒè½¬ä¸º Tensor ï¼š     `transforms.ToTensor`
  - å°† Tensor è½¬ä¸º PIL å›¾åƒï¼š            `transforms.ToPILImage`
  - :star:æ ‡å‡†åŒ–ï¼š                                       `transforms.Normalize`
  - å¡«å……ï¼š                                                  `transforms.Pad`
  - ä¿®æ”¹äº®åº¦ã€å¯¹æ¯”åº¦ã€é¥±å’Œåº¦ï¼š    `transforms.ColorJitter`
  - :star:å°†å›¾åƒè½¬åŒ–ä¸ºç°åº¦å›¾ï¼š           `transforms.Grayscale`
  - ä»¥æ¦‚ç‡ $p$ å°†å›¾åƒè½¬åŒ–ä¸ºç°åº¦å›¾ï¼š`transforms.RandomGrayscale(p=0.5)`
  - çº¿æ€§å˜æ¢ï¼š                                         `transforms.LinearTransformation`
  - ä»¿å°„å˜æ¢ï¼š                                         `transforms.RandomAffine`
  - è‡ªå®šä¹‰å˜æ¢ï¼š                                    `transforms.Lambda`

- **å¯¹ Compose çš„å¤„ç†ï¼Œä½¿æ•°æ®å¢å¼ºæ›´çµæ´»ï¼š**
  - ä»è®¸å¤š transform æ“ä½œä¸­éšä¾¿é€‰ä¸€ä¸ªæ“ä½œï¼š  `transforms.RandomChoice(transforms)`
  - å¯¹äºæŸä¸€ä¸ª transform æ“ä½œä»¥ $p$ æ¦‚ç‡æ‰§è¡Œï¼š  `transforms.RandomApply(transforms, p=0.5)`
  - æ‰“ä¹± transform æ“ä½œçš„é¡ºåºï¼š                              `transforms.RandomOrder`



###### 2.2.1 è£å‰ªéƒ¨åˆ†

1. éšæœºè£å‰ªå‡½æ•°ï¼š`transforms.RandomCrop`ï¼Œä»å›¾åƒä¸­éšæœºè£å‰ªå‡ºä¸€ä¸ªç¬¦åˆ`size`å‚æ•°è¦æ±‚çš„å›¾åƒ

```py
torchvision.transforms.RandomCropï¼ˆ
	sizeï¼Œ	                 # å¿…é¡»è¾“å…¥é¡¹ï¼Œè¦ä¹ˆæ˜¯ 1 ä¸ª int æ•°ï¼Œè¦ä¹ˆæ˜¯ (h, w) åºåˆ—
    
    padding       = Noneï¼Œ	 # å›¾åƒæ¯ä¸ªè¾¹æ¡†ä¸Šçš„å¯é€‰å¡«å……ã€‚é»˜è®¤å€¼ä¸ºNoneï¼Œå³æ— å¡«å……ã€‚
    						  # å¦‚æœæä¾›é•¿åº¦ä¸º4çš„åºåˆ—ï¼Œåˆ™å®ƒç”¨äºåˆ†åˆ«å¡«å……å·¦ï¼Œä¸Šï¼Œå³ï¼Œä¸‹è¾¹ç•Œã€‚
        					  # å¦‚æœæä¾›é•¿åº¦ä¸º2çš„åºåˆ—ï¼Œåˆ™åˆ†åˆ«ç”¨äºå¡«å……å·¦/å³ï¼Œä¸Š/ä¸‹è¾¹ç•Œ
    
    pad_if_needed = Falseï¼Œ	 # å¦‚æœå°äºæ‰€éœ€å¤§å°ï¼Œå®ƒå°†å¡«å……å›¾åƒä»¥é¿å…å¼•å‘å¼‚å¸¸
    
    fill          = 0ï¼Œ	     # æ’å®šå¡«å……çš„å¡«å……å€¼.å¦‚æœé•¿åº¦ä¸º3çš„å…ƒç»„ï¼Œåˆ™åˆ†åˆ«ç”¨äºå¡«å……Rï¼ŒGï¼ŒBé€šé“
    
    padding_mode  ='constant' # å¡«å……ç±»å‹ï¼Œè¿™é‡Œæä¾›äº† 4 ç§å¡«å……æ¨¡å¼ï¼š
                              # 1.constantï¼Œå¸¸é‡ï¼ˆéœ€è¦æŒ‡å®šå‰é¢çš„å‚æ•°'fill'ï¼‰ï¼›
        					  # 2.edgeï¼ŒæŒ‰ç…§å›¾ç‰‡è¾¹ç¼˜çš„åƒç´ å€¼æ¥å¡«å……
            				  # 3.reflectï¼Œå…·æœ‰å›¾åƒåå°„çš„å«ï¼ˆä¸é‡å¤è¾¹ç¼˜ä¸Šçš„æœ€åä¸€ä¸ªå€¼ï¼‰
                			  # 4.symmetricï¼Œå…·æœ‰å›¾åƒåå°„çš„å«ï¼ˆé‡å¤è¾¹ç¼˜ä¸Šçš„æœ€åä¸€ä¸ªå€¼ï¼‰
ï¼‰
```

2. ä¸­å¿ƒè£å‰ªå‡½æ•°ï¼š`transforms.CenterCrop`ï¼Œä»å›¾åƒä¸­å¿ƒè£å‰ªå‡ºä¸€ä¸ªç¬¦åˆ`size`å‚æ•°è¦æ±‚çš„å›¾åƒ

```py
torchvision.transforms.CenterCrop(
    size	# å¿…é¡»è¾“å…¥é¡¹ï¼Œè¦ä¹ˆæ˜¯ 1 ä¸ª int æ•°ï¼Œè¦ä¹ˆæ˜¯ (h, w) åºåˆ—
) 
```

3. éšæœºé•¿å®½æ¯”è£å‰ªå‡½æ•°ï¼š`transforms.RandomResizedCrop`ï¼Œå°±æ˜¯å…ˆå°†ç»™å®šçš„å›¾åƒè¿›è¡Œéšæœºæ”¾ç¼©ï¼ˆæ¯”ä¾‹èŒƒå›´ç”± `scale` ç¡®å®šï¼‰ï¼Œå†å¯¹å›¾åƒçš„å®½é«˜æ¯”ä¾‹è¿›è¡Œéšæœºæ”¾ç¼©ï¼ˆå®½é«˜çš„æ¯”ä¾‹èŒƒå›´ç”± `ratio` ç¡®å®šï¼‰ã€‚åœ¨ä¸Šé¢ä¸¤ä¸ªæ“ä½œåšå®Œåï¼Œå†ä»å›¾åƒä¸­ä¸­å¿ƒè£å‰ªå‡ºç¬¦åˆ `size` å‚æ•°è¦æ±‚çš„å›¾åƒ

```py
torchvision.transforms.RandomResizedCrop(
    size, 					# å¿…é¡»è¾“å…¥é¡¹ï¼Œè¦ä¹ˆæ˜¯ 1 ä¸ª int æ•°ï¼Œè¦ä¹ˆæ˜¯ (h, w) åºåˆ—
    scale=(0.08, 1.0), 		# è£å‰ªçš„åŸå§‹å°ºå¯¸çš„å¤§å°èŒƒå›´
    ratio=(0.75, 1.3333333333333333), # è£å‰ªçš„åŸå§‹å®½é«˜æ¯”çš„å®½é«˜æ¯”èŒƒå›´
    interpolation=2			# å·®å€¼æ–¹æ³•ï¼šé»˜è®¤ 2ï¼ˆè¿™ä¸ª 2 å®é™…ä¸Šæ˜¯ PIL.Image.BILINEARï¼‰
)
```

4. ä¸Šä¸‹å·¦å³ä¸­å¿ƒè£å‰ªå‡½æ•°ï¼š`transforms.FiveCrop`ï¼Œå°±æ˜¯æŠŠä¸€å¼ å›¾çš„ä¸Šã€ä¸‹ã€å·¦ã€å³ã€ä¸­é—´è¿™äº”ä¸ªåœ°æ–¹å„è‡ªè£å‰ªå‡ºä¸€å¼ ç¬¦åˆ `size` å‚æ•°è¦æ±‚çš„å›¾åƒï¼ˆç›¸å½“äº 1 å¼ å›¾å˜æˆ 5 å¼ å›¾ï¼‰

```py
torchvision.transforms.FiveCrop(
    size	# å¿…é¡»è¾“å…¥é¡¹ï¼Œè¦ä¹ˆæ˜¯ 1 ä¸ª int æ•°ï¼Œè¦ä¹ˆæ˜¯ (h, w) åºåˆ—
)
```

> Noteï¼šå¦‚æœå¯¹ 1 å¼ å›¾åƒè¿›è¡Œ `FiveCrop` è¿›è¡Œå¤„ç†ï¼Œä¼šå¾—åˆ° 5 å¼ å›¾ï¼Œè€Œä¸”è¿™äº›å›¾ä¼šè¢«æ•´åˆåˆ°ä¸€ä¸ª 5D çš„ Tensor ä¸Šï¼ˆ`torch.Size(batchsizeï¼Œncropsï¼Œcï¼Œhï¼Œw)`ï¼‰ï¼Œåœ¨åç»­çš„å¤„ç†ä¸­è¿˜éœ€è¦æŠŠè¿™ä¸ª 5 ç»´çš„Tensorè½¬æˆå››ç»´ï¼ˆé€šå¸¸å¯ä»¥ç”¨`tensor.view()`æ¥å®ç°ï¼‰ï¼Œä¾‹å¦‚ï¼š

```py
bs, ncrops, c, h, w = input.size()
result = model(input.view(-1, c, h, w)) # å°† ncrops å’Œ batchsize æ•´åˆåˆ°ä¸€èµ·
```

5. ä¸Šä¸‹å·¦å³ä¸­å¿ƒè£å‰ªåç¿»è½¬å‡½æ•°ï¼š`transforms.TenCrop`ï¼Œå’Œå‰é¢çš„`transforms.FiveCrop`ç±»ä¼¼ï¼Œå°±æ˜¯ç›¸å½“äºåœ¨`transforms.FiveCrop`å¾—åˆ°çš„ 5 å¼ å›¾çš„åŸºç¡€ä¸Šå¯¹æ¯å¼ å›¾åšä¸€ä¸‹æ°´å¹³ç¿»è½¬æˆ–è€…å‚ç›´ç¿»è½¬ï¼Œå˜æˆ 10 å¼ å›¾

```py
torchvision.transforms.TenCrop(
    size, 					# å¿…é¡»è¾“å…¥é¡¹ï¼Œè¦ä¹ˆæ˜¯ 1 ä¸ª int æ•°ï¼Œè¦ä¹ˆæ˜¯ (h, w) åºåˆ—
    vertical_flip=False		# True å°±ç”¨å‚ç›´ç¿»è½¬ï¼ŒFalse å°±ç”¨æ°´å¹³ç¿»è½¬
)
```



###### 2.2.2 ç¿»è½¬å’Œæ—‹è½¬éƒ¨åˆ†

1. **ã€ç¿»è½¬ã€‘**ä»¥æ¦‚ç‡ $p$ æ°´å¹³ç¿»è½¬å‡½æ•°ï¼š`transforms.RandomHorizontalFlip(p=0.5)`ï¼Œä»¥ç»™å®šçš„æ¦‚ç‡ $p$ å¯¹è¾“å…¥å›¾åƒè¿›è¡Œéšæœºæ°´å¹³ç¿»è½¬ã€å·¦å³å¯¹è°ƒã€‘

```py
torchvision.transforms.RandomHorizontalFlip(
    p=0.5	# æ“ä½œæ¦‚ç‡ï¼Œé»˜è®¤å€¼ 0.5
)
```

2. **ã€ç¿»è½¬ã€‘**ä»¥æ¦‚ç‡ $p$ å‚ç›´ç¿»è½¬å‡½æ•°ï¼š`transforms.RandomVerticalFlip(p=0.5)`ï¼Œä»¥ç»™å®šçš„æ¦‚ç‡ $p$ å¯¹è¾“å…¥å›¾åƒè¿›è¡Œéšæœºå‚ç›´ç¿»è½¬ã€ä¸Šä¸‹å¯¹è°ƒã€‘

```python
torchvision.transforms.RandomVerticalFlip(
    p=0.5	# æ“ä½œæ¦‚ç‡ï¼Œé»˜è®¤å€¼ 0.5
)
```

3. **ã€æ—‹è½¬ã€‘**éšæœºæ—‹è½¬å‡½æ•°ï¼š`transforms.RandomRotation`ï¼ŒæŒ‰ç…§ç»™å®šçš„è§’åº¦èŒƒå›´å¯¹å›¾åƒè¿›è¡Œéšæœºæ—‹è½¬ï¼ˆå¯¹äºå¤„ç†çš„å›¾åƒè€Œè¨€ï¼Œè½¬æ˜¯ä¸€å®šä¼šè½¬çš„ï¼Œæ¯å¼ å›¾è½¬å¤šå°‘åº¦æ˜¯éšæœºçš„ï¼Œéšæœºçš„èŒƒå›´å–å†³äºè¾“å…¥çš„å‚æ•°`degrees`ï¼‰

```python
torchvision.transforms.RandomRotation(
    degrees, 		# éšæœºæ—‹è½¬çš„åº¦æ•°èŒƒå›´ï¼Œå¡«ä¸€ä¸ªintå€¼xæ—¶å°±æ˜¯Â±xÂ°ï¼Œå¡«å…ƒç»„çš„è¯å°±æŒ‰ç…§(min,max)è¿™æ ·ç®—
    
    resample=False, # é‡é‡‡æ ·æ—¶ä½¿ç”¨çš„è¿‡æ»¤å™¨ç±»å‹ï¼Œå¯é€‰é¡¹åŒ…æ‹¬ï¼š
    				# 1) PIL.Image.NEARESTã€è¾“å…¥å›¾åƒæ˜¯ç°åº¦å›¾æˆ– 8bit å½©è‰²å›¾ä¼šå¼ºåˆ¶ç”¨è¿™ç§è¿‡æ»¤å™¨ã€‘
    				# 2) PIL.Image.BILINEAR
    				# 3) PIL.Image.BICUBIC
    				# é»˜è®¤ä¸º False
    
    expand=False, 	# å¦‚æœä¸º Falseï¼Œæ—‹è½¬åçš„å›¾åƒä¼šä¿æŒåŸæ¥çš„sizeï¼Œä½†åŸå›¾ä¸­çš„éƒ¨åˆ†å†…å®¹è¢«â€œè½¬å‡ºå»äº†â€
    				# å¦‚æœä¸º Trueï¼Œæ—‹è½¬åè¦ä¿è¯åŸå›¾æ‰€æœ‰ä¿¡æ¯éƒ½åœ¨ï¼Œè¿™æ„å‘³ç€æ—‹è½¬åçš„å›¾åƒ size ä¼šå˜å¤§
    
    center=None,	# æ—‹è½¬ä¸­å¿ƒç‚¹ï¼Œé»˜è®¤ä¸ºä¸­å¿ƒ
    				# å¦‚æœæƒ³æ‰‹åŠ¨æŒ‡å®šä¹Ÿå¯ä»¥ç»™å®šä¸€ä¸ªå…ƒç»„åæ ‡ (x, y)
    
    fill=None		# æ˜¯å¦å¡«å……å› ä¸ºæ—‹è½¬å¤šå‡ºæ¥çš„â€œé»‘è¾¹â€ï¼ˆé»˜è®¤ä¸å¡«å……ï¼‰
    				# å¦‚æœè¦å¡«å……çš„è¯éœ€è¦åœ¨è¿™é‡Œç»™å®šä¸€ä¸ª RGB (å–å€¼èŒƒå›´ 0-255) çš„ä¸‰å…ƒç»„ï¼š(R,G,B)
)
```



###### 2.2.3 å¯¹å›¾åƒè¿›è¡Œå…¶ä»–å˜æ¢

1. ä¸Š / ä¸‹é‡‡æ ·å‡½æ•°ï¼š `transforms.Resize`ï¼Œå°†è¾“å…¥çš„ PIL å›¾åƒçš„å¤§å°è°ƒæ•´ä¸ºç»™å®šå¤§å°

```py
torchvision.transforms.Resize(
    size, 				# å¿…é¡»è¾“å…¥é¡¹ï¼Œè¦ä¹ˆæ˜¯ 1 ä¸ª int æ•°ï¼Œè¦ä¹ˆæ˜¯ (h, w) åºåˆ—
    					# åœ¨è¾“å…¥1ä¸ªæ•°æ—¶ï¼ŒåŸå›¾çš„å®½é«˜ä¸­è¾ƒå°çš„ä¼šè¢«è®¾å®šä¸º sizeï¼Œè€Œè¾ƒå¤§çš„åˆ™ä¼šæŒ‰æ¯”ä¾‹è°ƒæ•´
    
    interpolation=2,	# å·®å€¼æ–¹æ³•ï¼Œé»˜è®¤çš„ 2 å…¶å®å°±æ˜¯ PIL.Image.BILINEAR
    					
    max_size=None, 		# è°ƒæ•´åçš„å›¾åƒå®½é«˜ä¸­è¾ƒå¤§çš„è¾¹çš„æœ€å¤§å€¼
    					#ï¼ˆå°±æ˜¯å¦‚æœè®¾å®šçš„ size æ¯”è¿™é‡Œçš„ max_size å¤§ï¼Œåˆ™å†æ¬¡è°ƒæ•´å›¾åƒï¼Œä½¿å¾—è¿™ä¸ªé•¿è¾¹å¤§å°ä¸º max_sizeï¼‰
    antialias=None		# æŠ—é”¯é½¿æ ‡å¿—ï¼Œé€šå¸¸ä¸åšæ”¹åŠ¨
)
```

2. å°† PIL å›¾åƒè½¬ä¸º Tensor å‡½æ•°ï¼š `transforms.ToTensor`ï¼Œå°†å–å€¼èŒƒå›´ä¸º 0~255 çš„ PIL å›¾åƒè½¬ä¸ºå–å€¼èŒƒå›´ä¸º 0~1 çš„ Tensorã€‚

   > Noteï¼š PIL åº“æ‰“å¼€çš„å›¾åƒï¼ŒåŸå§‹çš„ shape ä¸º$(H \times W \times C)$ï¼Œè€Œç»è¿‡`transforms.ToTensor`å‡½æ•°å¤„ç†åçš„ Tensor çš„ shape ä¸º $(C \times H \times W)$

```py
torchvision.transforms.ToTensor()	# é€šå¸¸ä¸éœ€è¦åœ¨é‡Œé¢å®šå‚æ•°
```

3. å°† Tensor åè½¬å› PIL å›¾åƒå‡½æ•°ï¼š `transforms.ToPILImage`ï¼Œå°† Tensor æˆ–è€… np.ndarray çš„æ•°æ®è½¬æ¢ä¸º PIL  ç±»å‹å›¾åƒ

```py
torchvision.transforms.ToPILImage(
    mode=None	# é»˜è®¤ä¸º Noneï¼Œæ˜¯å•é€šé“ï¼ˆmode=3 å°±æ˜¯è½¬æ¢ä¸º RGB å›¾ï¼Œmode=4 å°±æ˜¯è½¬æ¢ä¸º RGBA å›¾ï¼‰
)
```

4. Tensor æ ‡å‡†åŒ–å‡½æ•°ï¼š`transforms.Normalize`ï¼Œç”¨å¹³å‡å€¼å’Œæ ‡å‡†åå·®å½’ä¸€åŒ–å¼ é‡å›¾åƒ

```py
torchvision.transforms.Normalize(
    mean, 	# æ¯ä¸ªé€šé“çš„å‡å€¼åºåˆ—å…ƒç»„   ï¼ˆè¦å¤„ç†çš„å›¾åƒæœ‰å¤šå°‘é€šé“ï¼Œè¿™é‡Œå°±è¦ç»™å¤šå°‘ä¸ªå€¼ï¼‰
    std		# æ¯ä¸ªé€šé“çš„æ ‡å‡†åå·®åºåˆ—å…ƒç»„ï¼ˆè¦å¤„ç†çš„å›¾åƒæœ‰å¤šå°‘é€šé“ï¼Œè¿™é‡Œå°±è¦ç»™å¤šå°‘ä¸ªå€¼ï¼‰
)
```

5. PIL å›¾åƒå¡«å……å‡½æ•° `transforms.Pad`ï¼Œä½¿ç”¨ç»™å®šçš„â€œpadâ€å€¼åœ¨æ‰€æœ‰é¢ä¸Šå¡«å……ç»™å®šçš„ PIL å›¾åƒï¼Œå°±æ˜¯æŠŠåŸå›¾æ”¾åœ¨ä¸€ä¸ª**æ–°çš„ç”»å¸ƒ**ï¼ˆå¤§å°ç”±`padding`å‚æ•°ç¡®å®šï¼‰é‡Œé¢ï¼Œç„¶åæ ¹æ®`fill`å‚æ•°å’Œ`padding_mode`å‚æ•°æ¥å†³å®šå¦‚ä½•æ¥å¡«å……æ–°ç”»å¸ƒä¸­çš„é»‘è¾¹åŒºåŸŸï¼š

```py
torchvision.transforms.Pad(
    padding, 	# æ¯ä¸ªè¾¹æ¡†ä¸Šçš„å¡«å……
    			# å¦‚æœæä¾›å•ä¸ª intï¼Œåˆ™ç”¨äºå¡«å……æ‰€æœ‰è¾¹æ¡†
    			# å¦‚æœæä¾›é•¿åº¦ä¸º 2 çš„å…ƒç»„ï¼Œåˆ™åˆ†åˆ«ä¸º å·¦/å³ å’Œ ä¸Š/ä¸‹ çš„å¡«å……
    			# å¦‚æœæä¾›é•¿åº¦ä¸º 4 çš„å…ƒç»„ï¼Œåˆ™åˆ†åˆ«ä¸º å·¦ï¼Œä¸Šï¼Œå³å’Œä¸‹è¾¹æ¡†çš„å¡«å……
    
    fill=0, 	# åªæœ‰å½“ä¸‹é¢çš„ padding_mode å‚æ•°å–å€¼ä¸ºä¸º'constant'æ—¶è¿™ä¸ªfillæ‰æœ‰ç”¨
    			# å¦‚æœåªç»™ä¸€ä¸ªå¸¸é‡ï¼Œé‚£è¿™ä¸ªæ•°å°±æ˜¯ç”¨æ¥å¡«å……åƒç´ çš„å€¼ï¼Œé»˜è®¤å€¼ä¸º0
    			# å¦‚æœé•¿åº¦ä¸º 3 çš„å…ƒç»„ï¼Œåˆ™åˆ†åˆ«ç”¨äºå¡«å…… Rï¼ŒGï¼ŒB é€šé“
    
    padding_mode='constant'	# å¡«å……ç±»å‹ï¼Œè¿™é‡Œæä¾›äº† 4 ç§å¡«å……æ¨¡å¼ï¼š
                            # 1.constantï¼Œå¸¸é‡ï¼ˆéœ€è¦æŒ‡å®šå‰é¢çš„å‚æ•°'fill'ï¼‰ï¼›
        					# 2.edgeï¼ŒæŒ‰ç…§å›¾ç‰‡è¾¹ç¼˜çš„åƒç´ å€¼æ¥å¡«å……
            				# 3.reflectï¼Œå…·æœ‰å›¾åƒåå°„çš„å«ï¼ˆä¸é‡å¤è¾¹ç¼˜ä¸Šçš„æœ€åä¸€ä¸ªå€¼ï¼‰
                			# 4.symmetricï¼Œå…·æœ‰å›¾åƒåå°„çš„å«ï¼ˆé‡å¤è¾¹ç¼˜ä¸Šçš„æœ€åä¸€ä¸ªå€¼ï¼‰
)
```

6. ä¿®æ”¹ PIL å›¾åƒçš„äº®åº¦ã€å¯¹æ¯”åº¦ã€é¥±å’Œåº¦çš„å‡½æ•°ï¼š `transforms.ColorJitter`ï¼Œæ ¹æ®è¾“å…¥çš„å‚æ•°èŒƒå›´æ¥éšæœºæ›´æ”¹å›¾åƒçš„äº®åº¦ï¼Œå¯¹æ¯”åº¦å’Œé¥±å’Œåº¦

```py
torchvision.transforms.ColorJitter(
    brightness=0, 	# äº®åº¦,[max(0,1-brightness)ï¼Œ1+brightness]æˆ–ç»™å®š[minï¼Œmax]æ¥éšæœºå–å€¼
    contrast=0, 	# å¯¹æ¯”åº¦,[max(0,1-contrast)ï¼Œ1+contrast]æˆ–ç»™å®š[minï¼Œmax]æ¥éšæœºå–å€¼
    saturation=0, 	# é¥±å’Œåº¦,[max(0,1-saturation)ï¼Œ1+saturation]æˆ–ç»™å®š[minï¼Œmax]æ¥éšæœºå–å€¼
    hue=0			# è‰²ç›¸,[-hueï¼Œhue]æˆ–ç»™å®šçš„[minï¼Œmax]æ¥éšæœºå–å€¼
)
```

7. å°† RGB å›¾åƒè½¬åŒ–ä¸ºç°åº¦å›¾åƒå‡½æ•°ï¼š`transforms.ColorJitter`

```py
torchvision.transforms.Grayscale(
    num_output_channels=1	# å‚æ•°ä¸º 1 æ—¶ï¼Œæ­£å¸¸çš„ç°åº¦å›¾ï¼Œå½“ä¸º 3 æ—¶ï¼Œ å°±åˆ¶ä½œ R=G=B çš„é€šé“å›¾
)
```

8. ä»¥æ¦‚ç‡ $p$ å°†å›¾åƒè½¬åŒ–ä¸ºç°åº¦å›¾å‡½æ•°ï¼š`transforms.RandomGrayscale(p=0.5)`ï¼Œå¯¹äºä¸‰é€šé“çš„RGBå›¾åƒï¼Œå‡½æ•°ç›´æ¥å°†å›¾åƒè½¬åŒ–ä¸º R=G=B çš„ç°åº¦å›¾

```py
torchvision.transforms.RandomGrayscale(
    p=0.1	# è½¬åŒ–æ¦‚ç‡
)
```

9. çº¿æ€§å˜æ¢å‡½æ•°ï¼š`transforms.LinearTransformation`ï¼Œä½¿ç”¨æ–¹å½¢å˜æ¢çŸ©é˜µå’Œç¦»çº¿è®¡ç®—çš„`mean_vector` å˜æ¢å¼ é‡å›¾åƒã€‚ç»™å®š`transformation_matrix`å’Œ`mean_vector`ï¼Œå°†ä½¿çŸ©é˜µå˜å¹³ã€‚ä»ä¸­æ‹‰ä¼¸å¹¶å‡å»`mean_vector`ï¼Œç„¶åç”¨å˜æ¢çŸ©é˜µè®¡ç®—ç‚¹ç§¯ï¼Œç„¶åå°†å¼ é‡é‡æ–°æ•´å½¢ä¸ºå…¶åŸå§‹å½¢çŠ¶ã€‚

   > Noteï¼š ç™½åŒ–è½¬æ¢ï¼šå‡è®¾$X$æ˜¯åˆ—å‘é‡é›¶ä¸­å¿ƒæ•°æ®ã€‚ç„¶åtorch.mmè®¡ç®—æ•°æ®åæ–¹å·®çŸ©é˜µ[D x D]ï¼Œå¯¹è¯¥çŸ©é˜µæ‰§è¡ŒSVDå¹¶å°†å…¶ä½œä¸ºtransformation_matrixä¼ é€’

```py
torchvision.transforms.LinearTransformation(
    transformation_matrix,	# å¼ é‡[D x D]ï¼ŒD = C x H x W.
    mean_vector				# å¼ é‡[D]ï¼ŒD = C x H x W.
) 
```

10. ä»¿å°„å˜æ¢å‡½æ•°ï¼š`transforms.RandomAffine`ï¼Œå¯¹å›¾åƒä¿æŒä¸­å¿ƒä¸å˜çš„éšæœºä»¿å°„å˜æ¢

```py
torchvision.transforms.RandomAffine(
    degrees, 	# è¦é€‰æ‹©çš„åº¦æ•°èŒƒå›´ï¼Œè®¾å®š 0 å¯åœç”¨æ—‹è½¬
    			# å¦‚æœ degrees æ˜¯ä¸€ä¸ªæ•°å­—è€Œä¸æ˜¯åƒï¼ˆminï¼Œmaxï¼‰è¿™æ ·çš„åºåˆ—ï¼Œåˆ™åº¦æ•°èŒƒå›´å°†æ˜¯ï¼ˆ-degreesï¼Œ+degreesï¼‰
    
    translate=None, # translateï¼ˆå…ƒç»„ï¼Œå¯é€‰ï¼‰ - 
    				# æ°´å¹³å’Œå‚ç›´å¹³ç§»çš„æœ€å¤§ç»å¯¹åˆ†æ•°å…ƒç»„
    				# ä¾‹å¦‚ translate =ï¼ˆaï¼Œbï¼‰ï¼Œç„¶ååœ¨èŒƒå›´-img_width * a <dx <img_width * aä¸­éšæœºé‡‡æ ·æ°´å¹³ç§»ä½
    				# å¹¶ä¸”åœ¨-img_height * b <dy <img_height * bèŒƒå›´å†…éšæœºé‡‡æ ·å‚ç›´ç§»ä½ã€‚é»˜è®¤æƒ…å†µä¸‹ä¸ä¼šç¿»è¯‘

    
    scale=None, 	# ç¼©æ”¾å› å­é—´éš”ï¼Œä¾‹å¦‚ï¼ˆaï¼Œbï¼‰ï¼Œç„¶åä»èŒƒå›´a<=scale<=bä¸­éšæœºé‡‡æ ·ç¼©æ”¾ã€‚é»˜è®¤æƒ…å†µä¸‹ä¼šä¿æŒåŸå§‹æ¯”ä¾‹
    
    shear=None, 	# è¦é€‰æ‹©çš„åº¦æ•°èŒƒå›´
    				# å¦‚æœdegreesæ˜¯ä¸€ä¸ªæ•°å­—è€Œä¸æ˜¯åƒï¼ˆminï¼Œmaxï¼‰è¿™æ ·çš„åºåˆ—ï¼Œåˆ™åº¦æ•°èŒƒå›´å°†æ˜¯ï¼ˆ-degreesï¼Œ+ degreesï¼‰
    
    resample=False, # # é‡é‡‡æ ·æ—¶ä½¿ç”¨çš„è¿‡æ»¤å™¨ç±»å‹ï¼Œå¯é€‰é¡¹åŒ…æ‹¬ï¼š
    				# 1) PIL.Image.NEARESTã€è¾“å…¥å›¾åƒæ˜¯ç°åº¦å›¾æˆ– 8bit å½©è‰²å›¾ä¼šå¼ºåˆ¶ç”¨è¿™ç§è¿‡æ»¤å™¨ã€‘
    				# 2) PIL.Image.BILINEAR
    				# 3) PIL.Image.BICUBIC
    				# é»˜è®¤ä¸º False
    
    fillcolor=0		# è¾“å‡ºå›¾åƒä¸­å˜æ¢å¤–éƒ¨åŒºåŸŸçš„å¯é€‰å¡«å……é¢œè‰²ï¼ˆä¹Ÿæ˜¯è¦æ±‚RGBä¸‰ä¸ªé€šé“ä¸€ä¸ªé€šé“ä¸€ä¸ªå€¼ï¼‰
) 
```

11. è‡ªå®šä¹‰å˜æ¢å‡½æ•°ï¼š`transforms.Lambda`

```py
torchvision.transforms.Lambda(
    lambda	# å¿…é¡»æŒ‡å®šçš„è‡ªå®šä¹‰ lambda å‡½æ•°
)
```



###### 2.2.4 å¯¹ Compose çš„å¤„ç†ï¼Œä½¿æ•°æ®å¢å¼ºæ›´çµæ´»